---
title: "PS270 Final Project"
author: "Harrison Crawford"
description: "The Unequal Burden of Cancer: Systemic Racial Disparities Regarding Access to Healthcare"
output:
  distill::distill_article:
    self_contained: false
---


## Introduction

Race is a complicated issue in the U.S., one that is influenced by a multitude of different factors. Systemic injustices that go back to before the founding of this country continue to influence daily life for people day. Injustices such as slavery, police brutality, Jim Crow laws, redlining, forced indigenous relocation, Japanese internment, colonialism in general and much, much more have a strong power that proves that these horrible acts and events are not simply in the past. In this analysis, a variety of factors will be analyzed to ascertain more specific ways that systemic disparities can be identified. Special focus is placed on cancer, as incidence and mortality of cancer is not uniformly distributed across all racial groups. The research question of interest here is how the mortality rate of cancer differs across racial groups. As a hypothesis, it is expected that mortality rates will be higher among those that are nonwhite. A correlation between race and income groups, with nonwhite people having a higher proportion of individuals receiving lower levels of income (to be specified later) as compared to white people, is also expected. Those with lower incomes likely have received less education and have reduced access to quality healthcare and therefore may not receive the treatment they need. In this analysis, we will analyze how race relates directly to mortality rates. We will also observe how race correlates with other factors that may more directly influence mortality rates, such as levels of income and education, proportions of uninsured people, and rates of late-stage diagnosis (Stage III or IV). All of these factors are also firmly tied to the history of racism in this country. The information being studied here is important because, upon discerning how mortality rates, and therefore healthcare disparities, are distributed across demographic groups, governments and organizations can more effectively create initiatives to correct these disparities by providing essential healthcare services to those who need it.   


## Data

The following data comes from the paper "Racial Disparities in Cancer Stage at Diagnosis and Survival for Adolescents and Young Adults" by Taparra, Kekumano, et al., published in the National Library of Medicine (https://pmc.ncbi.nlm.nih.gov/articles/PMC11365006/) on August 30, 2024. The research question in this study aligns well with the goals of this analysis, as the researchers wanted to understand any relationship between race and two variables: 1) cancer stage at diagnosis and 2) mortality rate. Because of this, the data is very useful in answering the research question being posed here. The data was collected retrospectively with the goal of creating a statistical analysis, covering those who received a diagnosis between January 1, 2004 and December 31, 2017. 

Loading the datasets and packages: 

```{r}
library(tidyverse)
finaldata <- read_csv("finaldata4.csv")
finaldataperc <- read_csv("finaldataperc.csv")
```

Data table previews: 
```{r}
finaldata_short <- finaldata |>
  select("Race", "Deceased", "Stage I", "Stage II", "Stage III")

knitr::kable(finaldata_short)
```


```{r}
finaldataperc_short <- finaldataperc |>
  select("Race", "Deceased", "Stage I", "Stage II", "Stage III")

knitr::kable(finaldataperc_short)
```

The study looks at five different races: 1) American Indian/Alaska Native, 2) Asian, 3) Black, 4) Native Hawaiian or Other Pacific Islander, and 5) White. There is also a sixth row to show the value of the variable across the entire population sample (Total). 

A total of 291,899 individuals are included in the study. Of these, 1,457 are American Indian/Alaska Native, 8,412 are Asian, 40,851 are Black, 987 are Native Hawaiian or Other Pacific Islander, and 240,192 are White. 

When looking at this study, there are two data sets to consider: the one labeled "finaldata" (finaldata4.csv), which contains the absolute numbers of peope who fit into each category in the study. There is also "finaldataperc" (finaldataperc.csv), which contains this same data in percentages. For the purposes of this analysis, finaldataperc will be the data set that is primarily used, for the following reason: 

```{r}
finaldata |>
  ggplot(aes(x = Race, y = `Medicaid or Medicare`)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The massive disparities here can partially be attributed to the fact that the vast majority of people sampled were white; therefore, it is informative to compare percentages instead of absolute number: 

```{r}
finaldataperc |>
  ggplot(aes(x = Race, y = `Medicaid or Medicare`)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


It is notable that the percentages do not refer to the percentage of the category, but percentage of the race; for example, the variable "Uninsured" does not contain 6% White, 9% Black, etc. Rather, it means that within the insurance sub-category (that includes the variables "Private insurance", "Medicaid or Medicare", and "Uninsured"), 76% of White people have private insurance, 18% are on Medicaid or Medicare, and 6% are uninsured.

The sub-categories are:

- Deceased
- Cancer stage ("Stage I", "Stage II", "Stage III", "Stage IV", "NA (CNS)")
- Type of cancer ("Breast", "Cervical", "CNS", "Colon or rectal", "Lung", "Lymphoma", "Melanoma", "Ovarian", "Sarcoma", "Testicular")
- Gender ("Female", "Male")
- Distance to hospital, km (this is not a percentage)
- Income ("Higher income", "Lower income")
- Urban/rural ("Metropolitan", "Urban-rural")
- Education ("More education", "Less education")
- Insurance ("Private insurance", "Medicaid or Medicare", "Uninsured")
- Treatment received ("Surgery", "Chemotherapy", "Radiotherapy")

For this analysis, we are not using the "Type of cancer", "Gender", "Distance to hospital", "Urban/rural", or "Treatment received" categories. 

The dependent variables here are "Deceased" , education (2 columns), income (2 columns), insurance (3 columns), and cancer stage (5 columns). The Deceased variable refers to those who both received a diagnosis and passed away due to cancer within the study period (2004-2017). In the education variable, an individual is classified as having "More education" if their level of education (high school, college, etc.) is greater than the median level of education in their county. In the income variable, an individual classifies as having "Higher income" when their annual income is greater than the median household income in their county and "Lower income" otherwise. Cancer stage, of course, refers to the stage at diagnosis, with the exception of central nervous system (CNS) cancer, which is not classified in the traditional stages.

The independent variable is race. We are looking to see how race influences the other variables.   


Below is a graph summarizing one of the relationship between race and mortality, one of the key questions of this analysis:

```{r}
deceased_graph <- finaldataperc |>
  ggplot(aes(x = Race, y = Deceased)) + 
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(deceased_graph)
```
The graph above demonstrates the percentages of people included in the study within each race that died of cancer. Among those included in the study, 15% of white people died, 24% of Black people died, 20% of American Indians or Alaska Natives died, 16% of Asian people died, and 22% of Native Hawaiians or other Pacific Islanders died. Across all races, 16% of people who had cancer died from it. These numbers indicate that all races had a higher rate of death from cancer than the average of all people, with the exceptions of white people, who had a lower average, and Asian people, whose average equaled the total population. Since there is such a disparity between the death rates of white people and most other races, the data suggests that white people have a higher chance of surviving cancer across all cancer types.



## Results

To get more types of models, we need to reshape the data.

```{r}
finaldataperc1 <- finaldataperc |>
  select("Race", "Deceased", "Stage I", "Stage II", "Stage III", "Stage IV", "NA (CNS)", "More education", "Less education", "Higher income", "Lower income", "Uninsured", "Private insurance", "Medicaid or Medicare")
```

```{r}
finaldataperc_long_income <- finaldataperc1 |>
  pivot_longer(cols = c("Higher income", "Lower income"),
               names_to = "Income Category",
               values_to = "Income Value")
```

```{r}
long_income_abbr <- finaldataperc_long_income |>
  select("Race", "Income Category", "Income Value")

knitr::kable(long_income_abbr)
```


Now, here is a visualization of the relationship between income category and race: 

```{r}
perc_income <- finaldataperc_long_income |>
  select("Race", "Income Category", "Income Value")
```


```{r}
ggplot(perc_income, aes(x = Race, y = `Income Value`, fill = `Income Category`)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Income Distribution by Race", 
       x = "Race", 
       y = "Percentage", 
       fill = "Income Level") +
   theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


Here is a visualization of the relationship between education level and race:

```{r}
finaldataperc_long_education <- finaldataperc1 |>
  pivot_longer(cols = c("More education", "Less education"),
               names_to = "Education Category",
               values_to = "Education Value")
```

```{r}
perc_education <- finaldataperc_long_education |>
  select("Race", "Education Category", "Education Value")
```

```{r}
ggplot(perc_education, aes(x = Race, y = `Education Value`, fill = `Education Category`)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Education Distribution by Race", 
       x = "Race", 
       y = "Percentage", 
       fill = "Education Level") +
   theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Now, the relationship between insurance status and race: 

```{r}
finaldataperc_long_insurance <- finaldataperc1 |>
  pivot_longer(cols = c("Uninsured", "Medicaid or Medicare", "Private insurance"),
               names_to = "Insurance Category",
               values_to = "Insurance Value")
```

```{r}
perc_insurance <- finaldataperc_long_insurance |>
  select("Race", "Insurance Category", "Insurance Value")
```


```{r}
ggplot(perc_insurance, aes(x = Race, y = `Insurance Value`, fill = `Insurance Category`)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Insurance Distribution by Race", 
       x = "Race", 
       y = "Percentage", 
       fill = "Insurance Level") +
   theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Here is the relationship between race and stage of cancer at the time of diagnosis: 

```{r}
finaldataperc_long_stage <- finaldataperc1 |>
  pivot_longer(cols = c("Stage I", "Stage II", "Stage III", "Stage IV", "NA (CNS)"),
               names_to = "Stage Category",
               values_to = "Stage Value")
```

```{r}
perc_stage <- finaldataperc_long_stage |>
  select("Race", "Stage Category", "Stage Value")
```

```{r}
ggplot(perc_stage, aes(x = Race, y = `Stage Value`, fill = `Stage Category`)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Stage Distribution by Race", 
       x = "Race", 
       y = "Percentage", 
       fill = "Stage Level") +
   theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Finally, we will create a linear regression to determine how a dependent variable (mortality rate) influences the independent variable (race). Mortality rate is selected because that is ultimately the most interesting variable for this study's purposes. The other four dependent variables are included primarily to determine trends across these variables; if white people have the highest percentage of people classified as "Higher income", do they also have the highest percentage of people classified as "More education", "Private insurance", and "Stage I" (diagnosing cancer early is indicative of regular check-ins with a doctor and it is positively correlated with survival rates)? 

```{r}
finaldataperc$Race <- factor(finaldataperc$Race, ordered = FALSE)
```

```{r}
finaldataperc$Race <- relevel(finaldataperc$Race, ref = "Overall")
```

```{r}
mortality_linear <- lm(Deceased ~ Race, data = finaldataperc)
mortality_linear
```
Using the "race" called "Overall" as the reference group, the regression demonstrates that:
- The intercept is 16.
- The White coefficient is -1.
- The Asian coefficient is near 0.
- The Black coefficient is 8.
- The Native Hawaiian/Pacific Islander coefficient is 6.
- The American Indian/Alaska Native coefficient is 4.

This means, in context, that the baseline mortality rate among the entire studied population is 16% (the intercept), which is consistent with the data. According to the regression, the American Indian/Alaska Native group has a mortality rate 4% larger than the Overall (20%), the Native Hawaiian/Pacific Islander group has a mortality rate 6% higher than the Overall (22%), the Black population has a mortality rate 8% larger than the Overall (24%), the Asian population has a mortality rate roughly equal to the Overall (~16%), and the white population has a mortality rate 1% lower than the Overall (15%). 


## Conclusion


## Milestone 4

The reason that the average is so low relative to the averages of all other races is because the subjects in this study were overwhelmingly white, bringing the average down considerably. It is the reason the data in the graph above looks at the percentages, rather than raw numbers, because the raw numbers would show that a larger number of white people died than any other race; this does not reflect the rate of death, it is reflective of how many white people were included in the study. 

Future data analysis can ascertain whether this trend remains consistent across each type of cancer. It is also worth analyzing whether other factors, such as rates of insurance coverage, education, and high income level follow the trends here: do white people have higher rates of being covered by private insurance? Getting higher education? Receiving more income? If there is a correlation, it is possible that those factors influence the rates at which people who have cancer die from it. 







